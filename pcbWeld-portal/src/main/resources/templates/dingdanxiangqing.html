<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<title>订单详情</title>
<link rel="stylesheet" href="/css/css.css" type="text/css">
<script type="text/javascript" src="/js/jquery-1.11.3.min.js"></script>
</head>
<body style="background:#f9f9f9;">
	<div class="top topshow">
		<div class="main">
			<img class="fl" src="/images/logo.png" alt=""/>
			<div class="fr toptxt">
				<a class="on" href="/jijia.html">在线计价</a>
				<a href="/shuoming.html">工艺说明</a>
				<a href="/denglu.html">登录</a> |
				<a href="/zhuce.html">注册</a>
			</div>
		</div>
	</div>
	
	<!--订单详情-->
	<div class="main DDxq">
		<h3><span>订单详情</span></h3>
		<div class="XQbox">
			<h4>订单状态</h4>
			<div class="shenheing">
				<p>资料审核中</p>
				<ul>
					<li>提交订单</li><!--class=on，审核通过-->
					<li><em></em>资料审核</li><!--此处通过后，在线支付按钮加上class=red，变红色-->
					<li><em></em>支付</li><!--class=fail，审核失败-->
					<li><em></em>物料寄送</li>
					<li><em></em>物料审核</li>
					<li><em></em>发货</li>
					<li><em></em>收货</li>
				</ul>
			</div>
		</div>
		<div class="XQbox">
			<h4>订单信息</h4>
			<div class="Ddxq">
				<p><span>创建时间：</span> <span th:text="${#dates.format(orderDO.createTime,'yyyy.MM.dd HH:mm:ss')}"></span></p>
				<p><span>订单号：</span><span id="dingdanhao" th:text="${orderDO.orderNo}">222569874458</span></p>
				<p><span>审核通过时间：</span>2020.03.12 12:23:42</p>
			</div>
		</div>
		<div class="XQbox">
			<h4>生产信息</h4>
			<table border="1" cellspacing="0" cellpadding="0" class="produc">
				<tbody id="xiangqingwuliaoqingdan">
				</tbody>
			</table>
		</div>

		<div class="XQbox">
			<h4>费用清单</h4>
			<table border="1" cellspacing="0" cellpadding="0" class="FYlist">
				<tbody id="dingdanxiangqingtbody">
				</tbody>
			</table>
		</div>

		<div class="XQbox">
			<h4>订单备注</h4>
			<div class="beizhu bdline">
				<dl>
					<dd th:text="${orderDO.beizhu}"></dd>
				</dl>
			</div>
			<h4>收货地址</h4>
			<div class="SHadd bdline">
				<p><span>收件人：</span><span th:text="${orderDO.consignee}"></span> </p>
				<p><span>收货地址：</span><span th:text="${orderDO.address}"></span></p>
				<p><span>手机号：</span><span th:text="${orderDO.mobile}"></span></p>
			</div>
			<h4>上传PCB文件</h4>
			<div class="download bdline">
				<span th:text="${orderDO.originalFilename}" id="yuanwenjianming"></span>
				<input type="button" value="下载查看文件" id="downloadFile"/>
				<input type="file" class="filess" name="pcb" style="opacity: 0"/>
				<input type="button" style="background:#fa5c72;" class="change_btn" value="重新上传文件"/>

			</div>

			<!--<h4>其他</h4>
			<div class="qita">
				<span>审核短信通知</span>
				<span>发货短信通知</span>
			</div>-->
		</div>
		<div class="XQbox">
			<h4>寄送物料信息填写</h4>
			<div class="tianxie">
				<div class="hezi">
					<span>寄送地址:</span>
					<div class="fr he">
						<p><em>收件人：</em><input type="text" name="materialConsignee" th:value="${orderDO.materialConsignee}" placeholder="请输入姓名"/><em>手机号：</em><input type="text" name="materialMobile" th:value="${orderDO.materialMobile}" placeholder="请输入手机号"/></p>
						<p><em>寄送地址：</em><input type="text" name="materialAddress" th:value="${orderDO.materialAddress}" style="width:90%;" placeholder="请输入地址"/></p>
					</div>
				</div>
				<div class="hezi">
					<span>寄送物流单号：</span>
					<div class="fl danhao">
						<input class="dh1" name="postid" th:value="${orderDO.postid}" type="text" placeholder="请输入物流单号"/>
						<input class="dh2" type="button" value="确定"/>
					</div>
				</div>

				<!--<div class="hezi">
					<span>第二次寄送物流单号：</span>
					<div class="fl danhao">
						<input class="dh1" type="text" placeholder="请输入物流单号"/>
						<input class="dh2" type="button" value="确定"/>
					</div>
				</div>-->

			</div>
		</div>
		
		<div class="XQbox">
			<h4 style="border-bottom:1px solid #e5e5e5;padding-bottom:15px;margin-bottom:30px;">物流信息</h4>
			<div class="wuliu">
				<p>发货方式：<span>快递</span></p>
				<p>物流公司：<span>顺丰速运</span></p>
				<p>运单号码：<span>2365897456213</span></p>
				<div class="WL">
					<span>物流跟踪：</span>
					<ul>
						<li>2020-04-19 17:41:27您的订单开始处理</li>
						<li>2020-04-20 08:50:19包裹正在等待揽收</li>
						<li>2020-04-20 19:52:04【太原市】韵达快递 山西太原朝阳街公司收件员 已揽件</li>
						<li>2020-04-20 23:54:43【太原市】快件已到达 山西太原分拨中心</li>
						<li>2020-04-21 00:55:35【太原市】山西太原分拨中心 已发出</li>
						<li>2020-04-21 01:27:34【太原市】山西太原分拨中心 已发出</li>
						<li>2020-04-21 20:06:58【济南市】快件已到达 山东济南分拨中心</li>
						<li>2020-04-21 20:19:32【济南市】山东济南分拨中心 已发出</li>
						<li>2020-04-22 08:04:43【济南市】山东济南天桥区水屯公司北园分部派件员：黄峰 电话：15753160208 当前正在为您派件</li>
					</ul>
				</div>
			</div>
		</div>
		

		
		<div class="XQbox">
			<h4>资料审核未通过原因</h4>
			<div class="Reason">
				Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Quis ipsum suspendisse ultrices gravida. Risus commodo viverra maecenas accumsan lacus vel facilisis. 
			</div>
		</div>
		




		<div class="zongE">
			应付总额：<span th:text="${orderDO.payAmount}"></span>
			<input type="button" class="red" value="在线支付" id="zaixianzhifu"/>
		</div>
	</div>
	
	<!--底部-->
	<div class="foot">
		<div class="main">
			<img class="fl whiteLogo" src="/images/logoWhite.png" alt=""/>
			<div class="fl fotNav">
				<p><a href="jijia.html">在线计价</a><a href="shuoming.html">工艺说明</a><a href="jieshao.html">公司介绍</a></p>
				<p><span>187  1018  4327</span></p>
				<p>地址：北京市大兴区嘉悦广场5号楼</p>
			</div>
			<div class="fr public">
				<img src="/images/gongzhonghao.png" alt=""/>
				<p>关注微信公众号</p>
			</div>
		</div>
	</div>
	
	<!--右侧浮条-->
	<div class="window QQ">
		<ul>
			<li class="back-to-top"><img src="/images/top-1.png" alt="" title="回到顶部"/></li>
			<li><a href="tencent://message/?Site=baidu.com&uin=290933560&Menu=yes"><img src="/images/top-3.png" alt="" title="QQ"/></a></li>
			<li><b><img src="/images/top-5.png" alt="" title="电话"/></b><span class="tell">18710184327</span></li>
			<li><b><img src="/images/top-2.png" alt="" title="微信"/></b><span class="weixin"><img width="125" height="125" src="/images/gongzhonghao.png" alt="" title="微信号"/></span></li>
			<li class="close"><img src="/images/top-4.png" alt="" title="关闭"/></li>
		</ul>
	</div>
	
</body>
<script type="text/javascript">
	//一件回顶部
	$(document).ready(function(){
		$(".back-to-top").click(function(event){
			event.preventDefault();
			$("html, body").animate({scrollTop:0},500);
		})
	});
	//关闭浮窗
	$(".close").click(function(){
		$(".QQ").addClass("fadeout");
	});
	//选择上传文件
	$(".change_btn").click(function () { $(".filess").click(); });
	$('.filess').change(function(){

           var file=$('.filess').val();
            $('#yuanwenjianming').text(file);
             var fm = new FormData();
        fm.append('orderNo', $("#dingdanhao").text());
        fm.append('pcbFile', $("[name='pcb']")[0].files[0]);
        $.ajax({
            type: "POST",
            url:"/information/order/reUpload",
            processData:false,
            contentType:false,
            async : false,
            cache:false,
            data: fm,
            success: function (data) {
                if(data.code==0){
                alert("重新上传成功");
                }
                else
                    alert(data.msg);
            }
        });
         })

          $("#downloadFile").click(function(){
          if($("#yuanwenjianming").text()==""){
			alert("您还没有上传过文件");
			return;
		}
         	 var orderNo = $("#dingdanhao").text();
         	 window.location.href="/information/order/downloadFile/"+orderNo;
          });

//物流单号
$(".dh2").click(function(){
	 var orderNo = $("#dingdanhao").text();
	 var materialConsignee= $("[name='materialConsignee']").val();
	 var materialAddress=$("[name='materialAddress']").val();
	 var materialMobile= $("[name='materialMobile']").val();
	 var postid=$("[name='postid']").val();
	  $.ajax({
            type: "POST",
            url:"/information/order/updatePostid",
            data:{
            	orderNo:orderNo,
            	materialConsignee:materialConsignee,
            	materialAddress:materialAddress,
            	materialMobile:materialMobile,
            	postid:postid
            },
            success: function (data) {
                if(data.code==0){
                alert("保存成功");
                }
                else
                    alert(data.msg);
            }
        });

})
</script>

<script th:inline="javascript">
	var arry = [[${dlist}]];
	var tr=$("<tr></tr>");
	var td="";
	for(var i=1;i<arry.length+1;i++){
		td+="<td>"+arry[i-1].name+"</td>";
		td+="<td>"+arry[i-1].buyNumber+"</td>";
		if(i%2==0){
			tr.append(td);
			$("#xiangqingwuliaoqingdan").append(tr);
			tr=$("<tr></tr>");
			td="";
		}else if(i==arry.length){
			tr=$("<tr></tr>");
			tr.append(td);
			tr.append("<td></td><td></td>");
			$("#xiangqingwuliaoqingdan").append(tr);
		}
		}

    var tr1=$("<tr></tr>");
    var td1="";
    arry.push({'name':'快递费用：','amount':20});
    for(var i=1;i<arry.length+1;i++){
        td1+="<td>"+arry[i-1].name+"<span>￥"+arry[i-1].amount+"</span></td>";
        if(i%2==0){
            tr1.append(td1);
            $("#dingdanxiangqingtbody").append(tr1);
            tr1=$("<tr></tr>");
            td1="";

        }else if(i==arry.length){
            tr1=$("<tr></tr>");
            tr1.append(td1);
            tr1.append("<td></td>");
            $("#dingdanxiangqingtbody").append(tr1);
        }
    }

		var orderStatus =[[${orderDO.orderStatus}]];
		switch(orderStatus){
			case 1: $(".shenheing >p:first").text("订单已提交");$(".shenheing li:eq(0)").addClass("on");break;
            case 2: $(".shenheing >p:first").text("资料审核中"); $(".shenheing li:eq(0)").addClass("on");break;
            case 3: $(".shenheing >p:first").text("资料审核");$(".shenheing li:eq(0)").addClass("on");$(".shenheing li:eq(1)").addClass("fail");break;
            case 4: $(".shenheing >p:first").text("待支付");$(".shenheing li:lt(2)").addClass("on"); break;
            case 5: $(".shenheing >p:first").text("物料寄送"); $(".shenheing li:lt(4)").addClass("on"); break;
            case 6: $(".shenheing >p:first").text("物料待审核");$(".shenheing li:lt(4)").addClass("on"); break;
            case 7: $(".shenheing >p:first").text("物料待审核"); $(".shenheing li:lt(4)").addClass("on");$(".shenheing li:eq(4)").addClass("fail");break;
            case 8: $(".shenheing >p:first").text("待发货"); $(".shenheing li:lt(5)").addClass("on");break;
            case 9: $(".shenheing >p:first").text("待收货");$(".shenheing li:lt(6)").addClass("on"); break;
            case 10: $(".shenheing >p:first").text("已完成");$(".shenheing li").addClass("on"); break; break;
		}
		//支付
	$("#zaixianzhifu").click(function(){
	    var orderNo=$("#dingdanhao").text();
	    var payMount = $(this).prev().text();
	    console.info(orderNo);
	    console.info(payMount);
	    window.location.href="/information/order/zaixianzhifu?orderNo="+orderNo+"&payMount="+payMount;
	});
</script>
</html>
